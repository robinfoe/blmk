{"version":3,"sources":["meteor://ðŸ’»app/packages/miro_preloader/packages/miro_preloader.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6H","file":"/packages/miro_preloader.js","sourcesContent":["(function () {\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// packages/miro:preloader/lib/client_route_controller.js                                                           //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\n// v1.2.3                                                                                                           // 1\n                                                                                                                    // 2\nvar verbose = false,                                                                                                // 3\n\tsetVerbose = function ( self ) {                                                                                   // 4\n\t\tverbose = (                                                                                                       // 5\n\t\t\tself.router.options.preload &&                                                                                   // 6\n\t\t\tself.router.options.preload.verbose &&                                                                           // 7\n\t\t\t( typeof console === 'object' )                                                                                  // 8\n\t\t);                                                                                                                // 9\n\t},                                                                                                                 // 10\n                                                                                                                    // 11\n\tConsole = {                                                                                                        // 12\n\t\tinfo : function ( params ) {                                                                                      // 13\n\t\t\tif ( verbose ) console.info( params );                                                                           // 14\n\t\t},                                                                                                                // 15\n                                                                                                                    // 16\n\t\twarn : function ( params ) {                                                                                      // 17\n\t\t\tif ( verbose ) console.warn( params );                                                                           // 18\n\t\t},                                                                                                                // 19\n                                                                                                                    // 20\n\t\terror: function ( params ) {                                                                                      // 21\n\t\t\tif ( verbose ) console.error( params );                                                                          // 22\n\t\t}                                                                                                                 // 23\n\t};                                                                                                                 // 24\n                                                                                                                    // 25\nPreloader = {                                                                                                       // 26\n\tloadLibs: function ( controller ) {                                                                                // 27\n\t\tvar self          = this,                                                                                         // 28\n\t\t\tdefaults      = {                                                                                                // 29\n\t\t\t\t// Default time-out for checking the library load                                                               // 30\n\t\t\t\ttimeOut: 2000\t// ms                                                                                             // 31\n\t\t\t},                                                                                                               // 32\n\t\t\tthisRoute     = controller.route,                                                                                // 33\n\t\t\tstyleCounter,                                                                                                    // 34\n                                                                                                                    // 35\n\t\t\tupdateCachedList = function ( loadingList ) {                                                                    // 36\n\t\t\t\tfor ( var key in loadingList ) {                                                                                // 37\n\t\t\t\t\tself.router._libs[ key ] = _.unique( _.union( self.router._libs[ key ] || [], loadingList[ key ] ) );          // 38\n\t\t\t\t}                                                                                                               // 39\n\t\t\t},                                                                                                               // 40\n                                                                                                                    // 41\n\t\t\tloadStyles = function () {                                                                                       // 42\n\t\t\t\tvar absoluteUrl = Meteor.absoluteUrl(),                                                                         // 43\n\t\t\t\t\trouteStyles = _.map( thisRoute._libs.sources.styles, function ( link ) {                                       // 44\n\t\t\t\t\t\tif ( _.isArray( link ) ) {                                                                                    // 45\n\t\t\t\t\t\t\treturn _.map( link, function ( singleLink ) {                                                                // 46\n\t\t\t\t\t\t\t\treturn singleLink.replace( absoluteUrl, '/' );                                                              // 47\n\t\t\t\t\t\t\t});                                                                                                          // 48\n\t\t\t\t\t\t} else {                                                                                                      // 49\n\t\t\t\t\t\t\treturn link.replace( absoluteUrl, '/' );                                                                     // 50\n\t\t\t\t\t\t}                                                                                                             // 51\n\t\t\t\t\t}),                                                                                                            // 52\n\t\t\t\t\tcurrentStyles = _.map( $( 'link[ rel*=preload ]' ), function ( link ) {                                        // 53\n\t\t\t\t\t\treturn link.href.replace( absoluteUrl, '/' );                                                                 // 54\n\t\t\t\t\t}),                                                                                                            // 55\n\t\t\t\t\tallStyles = _.union( currentStyles, routeStyles ),                                                             // 56\n\t\t\t\t\texcessStyles = _.difference( allStyles, routeStyles ),                                                         // 57\n\t\t\t\t\tretainedStyles = _.difference( currentStyles, excessStyles ),                                                  // 58\n\t\t\t\t\tnewStyles = _.difference( routeStyles, retainedStyles );                                                       // 59\n                                                                                                                    // 60\n\t\t\t\t// Remove excess styles                                                                                         // 61\n\t\t\t\tif ( excessStyles.length ) {                                                                                    // 62\n\t\t\t\t\t_.map( excessStyles, function ( style ) {                                                                      // 63\n\t\t\t\t\t\t$( 'link[ href=\"' + style + '\" ]' ).remove();                                                                 // 64\n                                                                                                                    // 65\n\t\t\t\t\t\tConsole.warn( '[ Preloader - Styles ] Removing: ' + style );                                                  // 66\n\t\t\t\t\t});                                                                                                            // 67\n\t\t\t\t}                                                                                                               // 68\n                                                                                                                    // 69\n\t\t\t\tif ( newStyles.length ) {                                                                                       // 70\n\t\t\t\t\tstyleCounter = 0;                                                                                              // 71\n                                                                                                                    // 72\n\t\t\t\t\tConsole.info( '[ Preloader - Styles ] Loading initiated...' );                                                 // 73\n                                                                                                                    // 74\n\t\t\t\t\t$.map( newStyles, function ( styleFile ) {                                                                     // 75\n\t\t\t\t\t\tstyleCounter++;                                                                                               // 76\n                                                                                                                    // 77\n\t\t\t\t\t\t$( 'head' ).append( '<link rel=\"preload stylesheet\" type=\"text/css\" href=\"' + styleFile + '\"/>' );            // 78\n                                                                                                                    // 79\n\t\t\t\t\t\tConsole.info( '[ Preloader - Styles ] Loading ' + styleCounter + '/' + newStyles.length + ': ' + styleFile ); // 80\n\t\t\t\t\t});                                                                                                            // 81\n                                                                                                                    // 82\n\t\t\t\t\tConsole.info( '[ Preloader - Styles ] Loading finished.' );                                                    // 83\n\t\t\t\t}                                                                                                               // 84\n\t\t\t},                                                                                                               // 85\n                                                                                                                    // 86\n\t\t\tloadAsync = function () {                                                                                        // 87\n\t\t\t\tvar asyncLibs          = thisRoute._libs.sources.async,                                                         // 88\n\t\t\t\t\tbeforeAsyncHandler = thisRoute._libs.onBeforeAsync,                                                            // 89\n\t\t\t\t\tasyncHandler       = thisRoute._libs.onAsync,                                                                  // 90\n\t\t\t\t\tafterAsyncHandler  = thisRoute._libs.onAfterAsync;                                                             // 91\n                                                                                                                    // 92\n\t\t\t\tself._totalAsyncFiles = asyncLibs.length;                                                                       // 93\n                                                                                                                    // 94\n\t\t\t\tif ( asyncLibs.length ) {                                                                                       // 95\n                                                                                                                    // 96\n\t\t\t\t\t$.ajaxSetup({                                                                                                  // 97\n\t\t\t\t\t\t// Ensure asynchronous load                                                                                   // 98\n\t\t\t\t\t\tasync: true                                                                                                   // 99\n\t\t\t\t\t});                                                                                                            // 100\n                                                                                                                    // 101\n\t\t\t\t\tself._asyncCounter = 0;                                                                                        // 102\n                                                                                                                    // 103\n\t\t\t\t\tConsole.info( '[ Preloader - Async ] Loading initiated...' );                                                  // 104\n                                                                                                                    // 105\n\t\t\t\t\t_.map( asyncLibs, function ( asyncLib ) {                                                                      // 106\n\t\t\t\t\t\tvar beforeAsync = true,                                                                                       // 107\n\t\t\t\t\t\t\tafterAsync = true;                                                                                           // 108\n                                                                                                                    // 109\n\t\t\t\t\t\tself._asyncCounter++;                                                                                         // 110\n                                                                                                                    // 111\n\t\t\t\t\t\tif ( beforeAsyncHandler ) {                                                                                   // 112\n\t\t\t\t\t\t\t// Give user a chance to manipulate                                                                          // 113\n\t\t\t\t\t\t\t// particular library if needed                                                                              // 114\n\t\t\t\t\t\t\tbeforeAsync = beforeAsyncHandler( asyncLib );                                                                // 115\n\t\t\t\t\t\t}                                                                                                             // 116\n                                                                                                                    // 117\n\t\t\t\t\t\tif ( beforeAsync ) {                                                                                          // 118\n                                                                                                                    // 119\n\t\t\t\t\t\t\tConsole.info( '[ Preloader - Async ] Loading ' + self._asyncCounter + '/' + self._totalAsyncFiles + ': ' + asyncLib );\n                                                                                                                    // 121\n\t\t\t\t\t\t\t$.getScript( asyncLib )                                                                                      // 122\n\t\t\t\t\t\t\t\t.done( function ( script, textStatus ) {                                                                    // 123\n                                                                                                                    // 124\n\t\t\t\t\t\t\t\t\tConsole.info( '[ Preloader - Async ] Loading ' + asyncLib + ': SUCCESS' );                                 // 125\n                                                                                                                    // 126\n\t\t\t\t\t\t\t\t\t// Update list of loaded resources,                                                                        // 127\n\t\t\t\t\t\t\t\t\t// so we don't reload them                                                                                 // 128\n\t\t\t\t\t\t\t\t\tupdateCachedList({                                                                                         // 129\n\t\t\t\t\t\t\t\t\t\tasync: [ asyncLib ]                                                                                       // 130\n\t\t\t\t\t\t\t\t\t});                                                                                                        // 131\n                                                                                                                    // 132\n\t\t\t\t\t\t\t\t\tif ( asyncHandler ) {                                                                                      // 133\n\t\t\t\t\t\t\t\t\t\tasyncHandler( null, {                                                                                     // 134\n\t\t\t\t\t\t\t\t\t\t\t// Send SUCCESS info back                                                                                // 135\n\t\t\t\t\t\t\t\t\t\t\tfileName  : asyncLib,                                                                                    // 136\n\t\t\t\t\t\t\t\t\t\t\tscript    : script,                                                                                      // 137\n\t\t\t\t\t\t\t\t\t\t\tstatus    : textStatus,                                                                                  // 138\n\t\t\t\t\t\t\t\t\t\t\tcounter   : self._asyncCounter,                                                                          // 139\n\t\t\t\t\t\t\t\t\t\t\ttotalFiles: self._totalAsyncFiles                                                                        // 140\n\t\t\t\t\t\t\t\t\t\t});                                                                                                       // 141\n\t\t\t\t\t\t\t\t\t}                                                                                                          // 142\n\t\t\t\t\t\t\t\t})                                                                                                          // 143\n\t\t\t\t\t\t\t\t.fail( function ( jqxhr, textStatus, exception ) {                                                          // 144\n                                                                                                                    // 145\n\t\t\t\t\t\t\t\t\tConsole.error( '[ Preloader - Async ] Loading ' + asyncLib + ': ERROR - ' + jqxhr.status + ' (\\'' + textStatus + '\\'): \\'' + exception.message + '\\'' );\n                                                                                                                    // 147\n\t\t\t\t\t\t\t\t\tif ( asyncHandler ) {                                                                                      // 148\n\t\t\t\t\t\t\t\t\t\tasyncHandler({                                                                                            // 149\n\t\t\t\t\t\t\t\t\t\t\t// Send Error info back                                                                                  // 150\n\t\t\t\t\t\t\t\t\t\t\tfileName  : asyncLib,                                                                                    // 151\n\t\t\t\t\t\t\t\t\t\t\tjqxhr     : jqxhr,                                                                                       // 152\n\t\t\t\t\t\t\t\t\t\t\tstatus    : textStatus,                                                                                  // 153\n\t\t\t\t\t\t\t\t\t\t\texception : exception,                                                                                   // 154\n\t\t\t\t\t\t\t\t\t\t\tcounter   : self._asyncCounter,                                                                          // 155\n\t\t\t\t\t\t\t\t\t\t\ttotalFiles: self._totalAsyncFiles                                                                        // 156\n\t\t\t\t\t\t\t\t\t\t});                                                                                                       // 157\n\t\t\t\t\t\t\t\t\t}                                                                                                          // 158\n\t\t\t\t\t\t\t\t});                                                                                                         // 159\n\t\t\t\t\t\t}                                                                                                             // 160\n                                                                                                                    // 161\n\t\t\t\t\t\tif ( afterAsyncHandler ) {                                                                                    // 162\n\t\t\t\t\t\t\tafterAsync = afterAsyncHandler( asyncLib );                                                                  // 163\n\t\t\t\t\t\t}                                                                                                             // 164\n                                                                                                                    // 165\n\t\t\t\t\t\tif ( afterAsync ) {                                                                                           // 166\n\t\t\t\t\t\t\t// Update list of loaded resources,                                                                          // 167\n\t\t\t\t\t\t\t// so we don't reload them;                                                                                  // 168\n\t\t\t\t\t\t\t// May be prevented by custom code                                                                           // 169\n\t\t\t\t\t\t\tupdateCachedList({                                                                                           // 170\n\t\t\t\t\t\t\t\tasync: [ asyncLib ]                                                                                         // 171\n\t\t\t\t\t\t\t});                                                                                                          // 172\n\t\t\t\t\t\t}                                                                                                             // 173\n\t\t\t\t\t});                                                                                                            // 174\n                                                                                                                    // 175\n\t\t\t\t\tConsole.info( '[ Preloader - Async ] Initialization finished.' );                                              // 176\n\t\t\t\t} else {                                                                                                        // 177\n\t\t\t\t\tConsole.info( '[ Preloader - Async ] All libraries already loaded.' );                                         // 178\n\t\t\t\t}                                                                                                               // 179\n\t\t\t},                                                                                                               // 180\n                                                                                                                    // 181\n\t\t\tloadSync = function () {                                                                                         // 182\n\t\t\t\tvar syncLibs = thisRoute._libs,                                                                                 // 183\n\t\t\t\t\tbeforeSyncHandler = thisRoute._libs.onBeforeSync,                                                              // 184\n\t\t\t\t\tsyncHandler       = thisRoute._libs.onSync,                                                                    // 185\n\t\t\t\t\tafterSyncHandler  = thisRoute._libs.onAfterSync;                                                               // 186\n                                                                                                                    // 187\n\t\t\t\tif ( syncLibs.sources.sync.length && !syncLibs.ready ) {                                                        // 188\n                                                                                                                    // 189\n\t\t\t\t\tConsole.info( '[ Preloader - Sync ] Loading initiated...' );                                                   // 190\n                                                                                                                    // 191\n\t\t\t\t\t$.ajaxSetup({                                                                                                  // 192\n\t\t\t\t\t\t// Ensure synchronous load                                                                                    // 193\n\t\t\t\t\t\tasync: false                                                                                                  // 194\n\t\t\t\t\t});                                                                                                            // 195\n                                                                                                                    // 196\n\t\t\t\t\tself._totalLibFiles = syncLibs.sources.sync.length;                                                            // 197\n\t\t\t\t\tself._libCounter = 1;                                                                                          // 198\n                                                                                                                    // 199\n\t\t\t\t\tself._lib = {                                                                                                  // 200\n\t\t\t\t\t\tsource   : syncLibs.sources.sync[ 0 ],                                                                        // 201\n\t\t\t\t\t\tisLoaded : false,                                                                                             // 202\n\t\t\t\t\t\tisChecked: false,                                                                                             // 203\n\t\t\t\t\t\tdeps     : {                                                                                                  // 204\n\t\t\t\t\t\t\tloaded : new Tracker.Dependency(),                                                                           // 205\n\t\t\t\t\t\t\tchecked: new Tracker.Dependency()                                                                            // 206\n\t\t\t\t\t\t}                                                                                                             // 207\n\t\t\t\t\t};                                                                                                             // 208\n                                                                                                                    // 209\n\t\t\t\t\tself._markCurrentLoaded = function () {                                                                        // 210\n\t\t\t\t\t\tself._libCounter++;                                                                                           // 211\n\t\t\t\t\t\tself._lib.isLoaded = true;                                                                                    // 212\n\t\t\t\t\t\tself._lib.deps.loaded.changed();                                                                              // 213\n\t\t\t\t\t};                                                                                                             // 214\n                                                                                                                    // 215\n\t\t\t\t\tself._isLoaded = function () {                                                                                 // 216\n\t\t\t\t\t\tself._lib.deps.loaded.depend();                                                                               // 217\n                                                                                                                    // 218\n\t\t\t\t\t\treturn self._lib.isLoaded;                                                                                    // 219\n\t\t\t\t\t};                                                                                                             // 220\n                                                                                                                    // 221\n\t\t\t\t\tself._isChecked = function () {                                                                                // 222\n\t\t\t\t\t\tself._lib.deps.checked.depend();                                                                              // 223\n                                                                                                                    // 224\n\t\t\t\t\t\treturn self._lib.isChecked;                                                                                   // 225\n\t\t\t\t\t};                                                                                                             // 226\n                                                                                                                    // 227\n\t\t\t\t\tself._preloadLib = function () {                                                                               // 228\n\t\t\t\t\t\tvar beforeSync = true;                                                                                        // 229\n                                                                                                                    // 230\n\t\t\t\t\t\tif ( beforeSyncHandler ) {                                                                                    // 231\n\t\t\t\t\t\t\t// Give user a chance to manipulate                                                                          // 232\n\t\t\t\t\t\t\t// particular library if needed                                                                              // 233\n\t\t\t\t\t\t\tbeforeSync = beforeSyncHandler( self._lib.source );                                                          // 234\n\t\t\t\t\t\t}                                                                                                             // 235\n                                                                                                                    // 236\n\t\t\t\t\t\tif ( beforeSync ) {                                                                                           // 237\n                                                                                                                    // 238\n\t\t\t\t\t\t\tConsole.info( '[ Preloader - Sync ] Loading ' + self._libCounter + '/' + self._totalLibFiles + ': ' + self._lib.source );\n                                                                                                                    // 240\n\t\t\t\t\t\t\t$.getScript( self._lib.source )                                                                              // 241\n\t\t\t\t\t\t\t\t.done( function ( script, textStatus ) {                                                                    // 242\n\t\t\t\t\t\t\t\t\tself._markCurrentLoaded();                                                                                 // 243\n\t\t\t\t\t\t\t\t})                                                                                                          // 244\n\t\t\t\t\t\t\t\t.fail( function ( jqxhr, textStatus, exception ) {                                                          // 245\n\t\t\t\t\t\t\t\t\t// TODO: Better error handling                                                                             // 246\n\t\t\t\t\t\t\t\t\tConsole.error( '[ Preloader - Sync ] Loading ' + self._libCounter + '/' + self._totalLibFiles + ': ERROR - ' + jqxhr.status + ' (\\'' + textStatus + '\\'): \\'' + exception.message + '\\'' );\n\t\t\t\t\t\t\t\t});                                                                                                         // 248\n\t\t\t\t\t\t}                                                                                                             // 249\n                                                                                                                    // 250\n\t\t\t\t\t\t// Mark library loaded so we don't reload them;                                                               // 251\n\t\t\t\t\t\t// May be prevented by custom code                                                                            // 252\n\t\t\t\t\t\tself._markCurrentLoaded();                                                                                    // 253\n\t\t\t\t\t};                                                                                                             // 254\n                                                                                                                    // 255\n\t\t\t\t\tself._preloadCheck = function () {                                                                             // 256\n\t\t\t\t\t\t// Call user's handler method(s) to let them                                                                  // 257\n\t\t\t\t\t\t// check if library finished initialization                                                                   // 258\n\t\t\t\t\t\tvar afterSync = true,                                                                                         // 259\n\t\t\t\t\t\t\ttimer = Meteor.setTimeout( function () {                                                                     // 260\n\t\t\t\t\t\t\t\t// Prevent endless run                                                                                      // 261\n\t\t\t\t\t\t\t\tself._lib.isChecked = true;                                                                                 // 262\n                                                                                                                    // 263\n\t\t\t\t\t\t\t\tMeteor.clearTimeout( timer );                                                                               // 264\n\t\t\t\t\t\t\t\tMeteor.clearInterval( interval );                                                                           // 265\n                                                                                                                    // 266\n\t\t\t\t\t\t\t\tself._lib.deps.checked.changed();                                                                           // 267\n                                                                                                                    // 268\n\t\t\t\t\t\t\t\tConsole.error( '[ Preloader - Sync ] Loading check: ERROR - Timeout' );                                     // 269\n\t\t\t\t\t\t\t}, routeLibs.timeOut ),                                                                                      // 270\n                                                                                                                    // 271\n\t\t\t\t\t\t\tinterval = Meteor.setInterval( function () {                                                                 // 272\n\t\t\t\t\t\t\t\t// Wait for library to finish loading                                                                       // 273\n\t\t\t\t\t\t\t\ttry {                                                                                                       // 274\n\t\t\t\t\t\t\t\t\tself._lib.isChecked = syncHandler( self._lib.source );                                                     // 275\n                                                                                                                    // 276\n\t\t\t\t\t\t\t\t\tif ( self._lib.isChecked ) {                                                                               // 277\n                                                                                                                    // 278\n\t\t\t\t\t\t\t\t\t\tMeteor.clearTimeout( timer );                                                                             // 279\n\t\t\t\t\t\t\t\t\t\tMeteor.clearInterval( interval );                                                                         // 280\n                                                                                                                    // 281\n\t\t\t\t\t\t\t\t\t\tself._lib.deps.checked.changed();                                                                         // 282\n                                                                                                                    // 283\n\t\t\t\t\t\t\t\t\t\tConsole.info( '[ Preloader - Sync ] Loading check: SUCCESS' );                                            // 284\n                                                                                                                    // 285\n\t\t\t\t\t\t\t\t\t\tif ( afterSyncHandler ) {                                                                                 // 286\n\t\t\t\t\t\t\t\t\t\t\tafterSync = afterSyncHandler( self._lib.source );                                                        // 287\n\t\t\t\t\t\t\t\t\t\t}                                                                                                         // 288\n                                                                                                                    // 289\n\t\t\t\t\t\t\t\t\t\tif ( afterSync ) {                                                                                        // 290\n\t\t\t\t\t\t\t\t\t\t\t// Update list of loaded resources, so we don't re-load them                                             // 291\n\t\t\t\t\t\t\t\t\t\t\tupdateCachedList({                                                                                       // 292\n\t\t\t\t\t\t\t\t\t\t\t\tsync: [ self._lib.source ]                                                                              // 293\n\t\t\t\t\t\t\t\t\t\t\t});                                                                                                      // 294\n\t\t\t\t\t\t\t\t\t\t}                                                                                                         // 295\n\t\t\t\t\t\t\t\t\t}                                                                                                          // 296\n\t\t\t\t\t\t\t\t} catch ( error ) {                                                                                         // 297\n\t\t\t\t\t\t\t\t\tConsole.error( '[ Preloader - Sync ] Loading check: ERROR - ' + error.message );                           // 298\n\t\t\t\t\t\t\t\t}                                                                                                           // 299\n\t\t\t\t\t\t\t}, 0 );\t// Run as often as possible                                                                          // 300\n\t\t\t\t\t};                                                                                                             // 301\n                                                                                                                    // 302\n\t\t\t\t\tself._deps = Tracker.autorun( function () {                                                                    // 303\n                                                                                                                    // 304\n\t\t\t\t\t\tif ( self._isLoaded() ) {                                                                                     // 305\n                                                                                                                    // 306\n\t\t\t\t\t\t\tif ( self._isChecked() ) {                                                                                   // 307\n                                                                                                                    // 308\n\t\t\t\t\t\t\t\tsyncLibs.sources.sync.shift();                                                                              // 309\n                                                                                                                    // 310\n\t\t\t\t\t\t\t\tif ( syncLibs.sources.sync.length > 0 ) {                                                                   // 311\n\t\t\t\t\t\t\t\t\tself._lib.source = syncLibs.sources.sync[ 0 ];                                                             // 312\n\t\t\t\t\t\t\t\t\tself._lib.isLoaded = false;                                                                                // 313\n\t\t\t\t\t\t\t\t\tself._lib.isChecked = false;                                                                               // 314\n\t\t\t\t\t\t\t\t\tself._lib.deps.loaded.changed();                                                                           // 315\n\t\t\t\t\t\t\t\t\tself._lib.deps.checked.changed();                                                                          // 316\n\t\t\t\t\t\t\t\t\tself._preloadLib();                                                                                        // 317\n\t\t\t\t\t\t\t\t} else {                                                                                                    // 318\n\t\t\t\t\t\t\t\t\t// We're done.                                                                                             // 319\n\t\t\t\t\t\t\t\t\tself._deps.stop();                                                                                         // 320\n\t\t\t\t\t\t\t\t\tvar routeName = syncLibs.controller.route.getName() || syncLibs.controller.route.path();                   // 321\n                                                                                                                    // 322\n\t\t\t\t\t\t\t\t\tConsole.info( '\\n[ Preloader - End ] Loading route \"' + routeName + '\" finished.\\n' );                     // 323\n                                                                                                                    // 324\n\t\t\t\t\t\t\t\t\tsyncLibs.ready = true;                                                                                     // 325\n\t\t\t\t\t\t\t\t\tsyncLibs.readyDeps.changed();                                                                              // 326\n\t\t\t\t\t\t\t\t}                                                                                                           // 327\n\t\t\t\t\t\t\t} else if ( syncHandler ) {                                                                                  // 328\n\t\t\t\t\t\t\t\tself._preloadCheck();                                                                                       // 329\n\t\t\t\t\t\t\t} else {                                                                                                     // 330\n\t\t\t\t\t\t\t\t// Continue with loading if there are no preload check handlers                                             // 331\n\t\t\t\t\t\t\t\t// Update list of loaded resources anyway, so we don't re-load them                                         // 332\n\t\t\t\t\t\t\t\tupdateCachedList({                                                                                          // 333\n\t\t\t\t\t\t\t\t\tsync: [ self._lib.source ]                                                                                 // 334\n\t\t\t\t\t\t\t\t});                                                                                                         // 335\n                                                                                                                    // 336\n\t\t\t\t\t\t\t\tself._lib.isChecked = true;                                                                                 // 337\n\t\t\t\t\t\t\t\tself._lib.deps.checked.changed();                                                                           // 338\n\t\t\t\t\t\t\t}                                                                                                            // 339\n\t\t\t\t\t\t}                                                                                                             // 340\n\t\t\t\t\t});                                                                                                            // 341\n                                                                                                                    // 342\n\t\t\t\t\t// Finally, do the deed!                                                                                       // 343\n\t\t\t\t\tself._preloadLib();                                                                                            // 344\n                                                                                                                    // 345\n\t\t\t\t} else {                                                                                                        // 346\n\t\t\t\t\tsyncLibs.ready = true;                                                                                         // 347\n\t\t\t\t\tsyncLibs.readyDeps.changed();                                                                                  // 348\n\t\t\t\t}                                                                                                               // 349\n                                                                                                                    // 350\n\t\t\t\treturn {                                                                                                        // 351\n\t\t\t\t\t// Return object with ready() method to be called to check the status                                          // 352\n\t\t\t\t\tready: function () {                                                                                           // 353\n\t\t\t\t\t\tsyncLibs.readyDeps.depend();                                                                                  // 354\n                                                                                                                    // 355\n\t\t\t\t\t\treturn syncLibs.ready;                                                                                        // 356\n\t\t\t\t\t}                                                                                                              // 357\n\t\t\t\t};                                                                                                              // 358\n\t\t\t},                                                                                                               // 359\n                                                                                                                    // 360\n\t\t\trouteName = thisRoute.getName() || thisRoute.path(),                                                             // 361\n                                                                                                                    // 362\n\t\t\trouteLibs = _.extend( defaults, thisRoute.options.preload ),                                                     // 363\n\t\t\t// These get overridden by route's settings!                                                                     // 364\n\t\t\tcontrollerLibs = _.extend( defaults, controller.preload ),                                                       // 365\n\t\t\trouterLibs = _.extend( defaults, controller.router.options.preload );                                            // 366\n                                                                                                                    // 367\n\t\tConsole.info( '\\n[ Preloader - Start ] Loading route \"' + routeName + '\"...\\n\\n' );                               // 368\n                                                                                                                    // 369\n\t\tif ( !self.router ) {                                                                                             // 370\n\t\t\tself.router = controller.router;                                                                                 // 371\n\t\t}                                                                                                                 // 372\n                                                                                                                    // 373\n\t\tif ( !self.router._libs ) {                                                                                       // 374\n\t\t\tself.router._libs = {                                                                                            // 375\n\t\t\t\tasync: [],                                                                                                      // 376\n\t\t\t\tsync : []                                                                                                       // 377\n\t\t\t};                                                                                                               // 378\n\t\t}                                                                                                                 // 379\n                                                                                                                    // 380\n\t\tif ( !thisRoute._libs ) {                                                                                         // 381\n\t\t\tthisRoute._libs = {                                                                                              // 382\n\t\t\t\tcontroller: controller,                                                                                         // 383\n\t\t\t\tsources  : {                                                                                                    // 384\n\t\t\t\t\tstyles: [],                                                                                                    // 385\n\t\t\t\t\tasync : [],                                                                                                    // 386\n\t\t\t\t\tsync  : []                                                                                                     // 387\n\t\t\t\t},                                                                                                              // 388\n\t\t\t\tonAsync  : null,                                                                                                // 389\n\t\t\t\tonSync   : null,                                                                                                // 390\n\t\t\t\tready    : false,                                                                                               // 391\n\t\t\t\treadyDeps: new Tracker.Dependency()                                                                             // 392\n\t\t\t};                                                                                                               // 393\n\t\t}                                                                                                                 // 394\n                                                                                                                    // 395\n\t\t// Router Libraries                                                                                               // 396\n\t\tif ( routerLibs.styles && typeof routerLibs.styles === 'string' ) {                                               // 397\n\t\t\trouterLibs.styles = ( routerLibs.styles === '' ) ? [] : [ routerLibs.styles ];                                   // 398\n\t\t}                                                                                                                 // 399\n                                                                                                                    // 400\n\t\tif ( routerLibs.async && typeof routerLibs.async === 'string' ) {                                                 // 401\n\t\t\trouterLibs.async = ( routerLibs.async === '' ) ? [] : [ routerLibs.async ];                                      // 402\n\t\t}                                                                                                                 // 403\n                                                                                                                    // 404\n\t\tif ( routerLibs.sync && typeof routerLibs.sync === 'string' ) {                                                   // 405\n\t\t\trouterLibs.sync = ( routerLibs.sync === '' ) ? [] : [ routerLibs.sync ];                                         // 406\n\t\t}                                                                                                                 // 407\n                                                                                                                    // 408\n\t\tif ( routerLibs.onBeforeAsync && typeof routerLibs.onBeforeAsync === 'function' ) {                               // 409\n\t\t\tthisRoute._libs.onBeforeAsync = routerLibs.onBeforeAsync;                                                        // 410\n\t\t}                                                                                                                 // 411\n                                                                                                                    // 412\n\t\tif ( routerLibs.onAsync && typeof routerLibs.onAsync === 'function' ) {                                           // 413\n\t\t\tthisRoute._libs.onAsync = routerLibs.onAsync;                                                                    // 414\n\t\t}                                                                                                                 // 415\n                                                                                                                    // 416\n\t\tif ( routerLibs.onBeforeSync && typeof routerLibs.onBeforeSync === 'function' ) {                                 // 417\n\t\t\tthisRoute._libs.onBeforeSync = routerLibs.onBeforeSync;                                                          // 418\n\t\t}                                                                                                                 // 419\n                                                                                                                    // 420\n\t\tif ( routerLibs.onSync && typeof routerLibs.onSync === 'function' ) {                                             // 421\n\t\t\tthisRoute._libs.onSync = routerLibs.onSync;                                                                      // 422\n\t\t}                                                                                                                 // 423\n                                                                                                                    // 424\n\t\t// Route Controller Libraries                                                                                     // 425\n\t\tif ( controllerLibs.styles && typeof controllerLibs.styles === 'string' ) {                                       // 426\n\t\t\tcontrollerLibs.styles = ( controllerLibs.styles === '' ) ? [] : [ controllerLibs.styles ];                       // 427\n\t\t}                                                                                                                 // 428\n                                                                                                                    // 429\n\t\tif ( controllerLibs.async && typeof controllerLibs.async === 'string' ) {                                         // 430\n\t\t\tcontrollerLibs.async = ( controllerLibs.async === '' ) ? [] : [ controllerLibs.async ];                          // 431\n\t\t}                                                                                                                 // 432\n                                                                                                                    // 433\n\t\tif ( controllerLibs.sync && typeof controllerLibs.sync === 'string' ) {                                           // 434\n\t\t\tcontrollerLibs.sync = ( controllerLibs.sync === '' ) ? [] : [ controllerLibs.sync ];                             // 435\n\t\t}                                                                                                                 // 436\n                                                                                                                    // 437\n\t\tif ( controllerLibs.onBeforeAsync && typeof controllerLibs.onBeforeAsync === 'function' ) {                       // 438\n\t\t\tthisRoute._libs.onBeforeAsync = controllerLibs.onBeforeAsync;                                                    // 439\n\t\t}                                                                                                                 // 440\n                                                                                                                    // 441\n\t\tif ( controllerLibs.onAsync && typeof controllerLibs.onAsync === 'function' ) {                                   // 442\n\t\t\tthisRoute._libs.onAsync = controllerLibs.onAsync;                                                                // 443\n\t\t}                                                                                                                 // 444\n                                                                                                                    // 445\n\t\tif ( controllerLibs.onBeforeSync && typeof controllerLibs.onBeforeSync === 'function' ) {                         // 446\n\t\t\tthisRoute._libs.onBeforeSync = controllerLibs.onBeforeSync;                                                      // 447\n\t\t}                                                                                                                 // 448\n                                                                                                                    // 449\n\t\tif ( controllerLibs.onSync && typeof controllerLibs.onSync === 'function' ) {                                     // 450\n\t\t\tthisRoute._libs.onSync = controllerLibs.onSync;                                                                  // 451\n\t\t}                                                                                                                 // 452\n                                                                                                                    // 453\n\t\t// Route Libraries                                                                                                // 454\n\t\tif ( routeLibs.styles && typeof routeLibs.styles === 'string' ) {                                                 // 455\n\t\t\trouteLibs.styles = ( routeLibs.styles === '' ) ? [] : [ routeLibs.styles ];                                      // 456\n\t\t}                                                                                                                 // 457\n                                                                                                                    // 458\n\t\tif ( routeLibs.async && typeof routeLibs.async === 'string' ) {                                                   // 459\n\t\t\trouteLibs.async = ( routeLibs.async === '' ) ? [] : [ routeLibs.async ];                                         // 460\n\t\t}                                                                                                                 // 461\n                                                                                                                    // 462\n\t\tif ( routeLibs.sync && typeof routeLibs.sync === 'string' ) {                                                     // 463\n\t\t\trouteLibs.sync = ( routeLibs.sync === '' ) ? [] : [ routeLibs.sync ];                                            // 464\n\t\t}                                                                                                                 // 465\n                                                                                                                    // 466\n\t\tif ( routeLibs.onBeforeAsync && typeof routeLibs.onBeforeAsync === 'function' ) {                                 // 467\n\t\t\tthisRoute._libs.onBeforeAsync = routeLibs.onBeforeAsync;                                                         // 468\n\t\t}                                                                                                                 // 469\n                                                                                                                    // 470\n\t\tif ( routeLibs.onAsync && typeof routeLibs.onAsync === 'function' ) {                                             // 471\n\t\t\tthisRoute._libs.onAsync = routeLibs.onAsync;                                                                     // 472\n\t\t}                                                                                                                 // 473\n                                                                                                                    // 474\n\t\tif ( routeLibs.onBeforeSync && typeof routeLibs.onBeforeSync === 'function' ) {                                   // 475\n\t\t\tthisRoute._libs.onBeforeSync = routeLibs.onBeforeSync;                                                           // 476\n\t\t}                                                                                                                 // 477\n                                                                                                                    // 478\n\t\tif ( routeLibs.onSync && typeof routeLibs.onSync === 'function' ) {                                               // 479\n\t\t\tthisRoute._libs.onSync = routeLibs.onSync;                                                                       // 480\n\t\t}                                                                                                                 // 481\n                                                                                                                    // 482\n\t\t// Consolidate libraries                                                                                          // 483\n\t\t// Route settings override Route Controller settings,                                                             // 484\n\t\t// which in turn override Router.configure() settings                                                             // 485\n\t\tthisRoute._libs.sources = _.defaults(                                                                             // 486\n\t\t\trouteLibs,                                                                                                       // 487\n\t\t\tcontrollerLibs,                                                                                                  // 488\n\t\t\trouterLibs                                                                                                       // 489\n\t\t) || {};                                                                                                          // 490\n                                                                                                                    // 491\n\t\tthisRoute._libs.sources.async  = _.difference(                                                                    // 492\n\t\t\tthisRoute._libs.sources.async,                                                                                   // 493\n\t\t\tcontroller.router._libs.async                                                                                    // 494\n\t\t) || [];                                                                                                          // 495\n                                                                                                                    // 496\n\t\tthisRoute._libs.sources.sync  = _.difference(                                                                     // 497\n\t\t\tthisRoute._libs.sources.sync,                                                                                    // 498\n\t\t\tcontroller.router._libs.sync                                                                                     // 499\n\t\t) || [];                                                                                                          // 500\n                                                                                                                    // 501\n\t\tif (                                                                                                              // 502\n\t\t\tthisRoute._libs.sources.styles &&                                                                                // 503\n\t\t\tthisRoute._libs.sources.styles.length &&                                                                         // 504\n\t\t\t!thisRoute._libs.sources.styles[ thisRoute._libs.sources.styles.length - 1 ]                                     // 505\n\t\t) {                                                                                                               // 506\n\t\t\tthisRoute._libs.sources.styles.pop();                                                                            // 507\n\t\t}                                                                                                                 // 508\n                                                                                                                    // 509\n\t\tif (                                                                                                              // 510\n\t\t\tthisRoute._libs.sources.async.length &&                                                                          // 511\n\t\t\t!thisRoute._libs.sources.async[ thisRoute._libs.sources.async.length - 1 ]                                       // 512\n\t\t) {                                                                                                               // 513\n\t\t\tthisRoute._libs.sources.async.pop();                                                                             // 514\n\t\t}                                                                                                                 // 515\n                                                                                                                    // 516\n\t\tif (                                                                                                              // 517\n\t\t\tthisRoute._libs.sources.sync.length &&                                                                           // 518\n\t\t\t!thisRoute._libs.sources.sync[ thisRoute._libs.sources.sync.length - 1 ]                                         // 519\n\t\t) {                                                                                                               // 520\n\t\t\tthisRoute._libs.sources.sync.pop();                                                                              // 521\n\t\t}                                                                                                                 // 522\n                                                                                                                    // 523\n\t\t// Finally, load the resources                                                                                    // 524\n\t\tloadStyles();                                                                                                     // 525\n                                                                                                                    // 526\n\t\tif ( thisRoute._libs.sources.async.length ) {                                                                     // 527\n\t\t\tloadAsync();                                                                                                     // 528\n\t\t} else {                                                                                                          // 529\n\t\t\tConsole.info( '[ Preloader - Async ] All libraries are already loaded.' );                                       // 530\n\t\t}                                                                                                                 // 531\n                                                                                                                    // 532\n\t\tif ( thisRoute._libs.sources.sync.length ) {                                                                      // 533\n\t\t\tthisRoute._libs.ready = false;                                                                                   // 534\n\t\t\tthisRoute._libs.readyDeps.changed();                                                                             // 535\n                                                                                                                    // 536\n\t\t\treturn loadSync();                                                                                               // 537\n\t\t} else {                                                                                                          // 538\n\t\t\tthisRoute._libs.ready = true;                                                                                    // 539\n\t\t\tthisRoute._libs.readyDeps.changed();                                                                             // 540\n                                                                                                                    // 541\n\t\t\tConsole.info( '[ Preloader - Sync ] All libraries are already loaded.' );                                        // 542\n\t\t}                                                                                                                 // 543\n                                                                                                                    // 544\n\t\tConsole.info( '\\n[ Preloader - End ] Loading route \"' + routeName + '\" finished.\\n' );                            // 545\n                                                                                                                    // 546\n\t\treturn {                                                                                                          // 547\n\t\t\t// Return object with ready() method to be called to check the status                                            // 548\n\t\t\tready: function () {                                                                                             // 549\n\t\t\t\t// We're okay                                                                                                   // 550\n\t\t\t\treturn true;                                                                                                    // 551\n\t\t\t}                                                                                                                // 552\n\t\t};                                                                                                                // 553\n\t}                                                                                                                  // 554\n};                                                                                                                  // 555\n                                                                                                                    // 556\nif ( typeof PreloadController === 'undefined' ) {                                                                   // 557\n\tPreloadController = RouteController.extend({                                                                       // 558\n\t\twaitOn: function () {                                                                                             // 559\n\t\t\tvar self = this;                                                                                                 // 560\n                                                                                                                    // 561\n\t\t\tsetVerbose( self );                                                                                              // 562\n                                                                                                                    // 563\n\t\t\treturn Preloader.loadLibs( self );                                                                               // 564\n\t\t},                                                                                                                // 565\n                                                                                                                    // 566\n\t\tonStop: function () {                                                                                             // 567\n\t\t\t// Handle route redirection                                                                                      // 568\n\t\t\tvar self      = this,                                                                                            // 569\n\t\t\t\trouteName = self.route._libs.controller.route.getName() ||                                                      // 570\n\t\t\t\t\t\t\tself.route._libs.controller.route.path();                                                                    // 571\n                                                                                                                    // 572\n\t\t\tsetVerbose( self );                                                                                              // 573\n                                                                                                                    // 574\n\t\t\tif ( !self.route._libs.ready ) {                                                                                 // 575\n\t\t\t\tif ( self._deps ) self._deps.stop();                                                                            // 576\n                                                                                                                    // 577\n\t\t\t\tself.route._libs.ready = false;                                                                                 // 578\n\t\t\t\tself.route._libs.readyDeps.changed();                                                                           // 579\n                                                                                                                    // 580\n\t\t\t\tConsole.warn( '\\n[ Preloader - Stop ] Loading for route \"' + routeName + '\" interrupted! (probably redirection...)\\n' );\n\t\t\t}                                                                                                                // 582\n\t\t}                                                                                                                 // 583\n\t});                                                                                                                // 584\n}                                                                                                                   // 585\n                                                                                                                    // 586\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n"]}